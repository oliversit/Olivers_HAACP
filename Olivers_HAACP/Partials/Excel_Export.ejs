<!doctype html>
<html>
<script type="text/javascript" src="//unpkg.com/xlsx/dist/shim.min.js"></script>
<script type="text/javascript" src="//unpkg.com/xlsx/dist/xlsx.full.min.js"></script>

<script type="text/javascript" src="//unpkg.com/blob.js@1.0.1/Blob.js"></script>
<script type="text/javascript" src="//unpkg.com/file-saver@1.3.3/FileSaver.js"></script>


<div id="container2">
	  
  <title>SheetJS Table Export</title>
  <table id="data-table" hidden>
    <tr>
      <td>Form Number</td>
		<td>Form</td>
		
			     <%
        if(userData2.length!=0){
        var i=1;
        userData2.forEach(function(data2){
        %>
	<td><%=data2.Question %></td>
			          <%  i++; }) %>
        <% } else{ %>
           			<div class="row" >
			
		<div class="col d-flex justify-content-center mt-5"  >
			<p>No Data Found</p>
	</div>
		
	
		</div>
              
            
        <% } %>
		
    </tr>
	  
	     <%
        if(userData.length!=0){
        var i=1;
        userData.forEach(function(data){
        %>
    <tr>
      <td><%=i; %></td>
		<td><%=FormBox %></td>
		<td><%=data.Date %></td>
		<td><%=data.Column_1 %></td>
		<td><%=data.Column_2 %></td>
		<td><%=data.Column_3 %></td>
		<td><%=data.Column_4 %></td>
		<td><%=data.Column_5 %></td>
		<td><%=data.Column_6 %></td>
		<td><%=data.Column_7 %></td>
		<td><%=data.Column_8 %></td>
		<td><%=data.Column_9 %></td>
		<td><%=data.Column_10 %></td>
		<td><%=data.Column_11 %></td>
		<td><%=data.Column_12 %></td>
		
    </tr>
	          <%  i++; }) %>
        <% } else{ %>
           			<div class="row" >
			
		<div class="col d-flex justify-content-center mt-5"  >
			<p>No Data Found</p>
	</div>
		
	
		</div>
              
            
        <% } %>
  </table>
</div>


<script type="text/javascript">

function doit(type, fn, dl) {
    var elt = document.getElementById('data-table');
    var wb = XLSX.utils.table_to_book(elt, {sheet:"Sheet JS"});
    return dl ?
        XLSX.write(wb, {bookType:type, bookSST:true, type: 'base64'}) :
        XLSX.writeFile(wb, fn || ('Report.' + (type || 'xlsx')));
}


function tableau(pid, iid, fmt, ofile) {
    if(typeof Downloadify !== 'undefined') Downloadify.create(pid,{
            swf: 'downloadify.swf',
            downloadImage: 'download.png',
            width: 100,
            height: 30,
            filename: ofile, data: function() { return doit(fmt, ofile, true); },
            transparent: false,
            append: false,
            dataType: 'base64',
            onComplete: function(){ alert('Your File Has Been Saved!'); },
            onCancel: function(){ alert('You have cancelled the saving of this file.'); },
            onError: function(){ alert('You must put something in the File Contents or there will be nothing to save!'); }
    });
}
tableau('xlsxbtn',  'xportxlsx',  'xlsx',  'test.xlsx');

</script>
</html>
